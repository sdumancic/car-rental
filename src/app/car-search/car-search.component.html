<!-- Main container -->
<div class="relative flex min-h-screen w-full flex-col justify-between overflow-x-hidden">
  <div class="w-full">
    <!-- Header -->
    <header class="sticky top-0 z-10 flex items-center justify-between bg-zinc-50/80 p-4 pb-3 backdrop-blur-sm dark:bg-zinc-900/80">
      <button class="flex h-10 w-10 items-center justify-center rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800" (click)="goBack()">
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>
      <h1 class="text-lg font-bold">Find a Ride</h1>
      <div class="w-10"></div>
    </header>

    <!-- Main content -->
    <main class="p-4">
      <!-- ...existing main content... -->
      <h2 class="text-3xl font-bold">Find your perfect ride</h2>
      <form class="mt-6 space-y-4" (ngSubmit)="onSearch()">
        <!-- Date selection grid -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="text-sm font-medium text-zinc-600 dark:text-zinc-400" for="start-date">Reservation starts</label>
            <div class="relative mt-2">
              <!-- Hidden native datepicker -->
              <input
                class="form-input opacity-0 absolute inset-0 w-full h-full cursor-pointer z-10"
                id="start-date"
                [(ngModel)]="startDate"
                name="startDate"
                type="date" />
              <!-- Visible formatted display -->
              <div class="form-input flex items-center pointer-events-none">
                <span class="flex-1">{{ startDateDisplay || 'DD.MM.YYYY' }}</span>
                <svg class="h-5 w-5 text-zinc-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
            </div>
          </div>
          <div>
            <label class="text-sm font-medium text-zinc-600 dark:text-zinc-400" for="end-date">Reservation ends</label>
            <div class="relative mt-2">
              <!-- Hidden native datepicker -->
              <input
                class="form-input opacity-0 absolute inset-0 w-full h-full cursor-pointer z-10"
                id="end-date"
                [(ngModel)]="endDate"
                name="endDate"
                type="date" />
              <!-- Visible formatted display -->
              <div class="form-input flex items-center pointer-events-none">
                <span class="flex-1">{{ endDateDisplay || 'DD.MM.YYYY' }}</span>
                <svg class="h-5 w-5 text-zinc-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
            </div>
          </div>
        </div>
        <!-- Car Type Filter -->
        <div>
          <label class="text-sm font-medium text-zinc-600 dark:text-zinc-400 mb-2 block">Car Type</label>
          <div class="flex flex-wrap gap-2">
            <button (click)="selectedCarType = ''"
                    [ngClass]="{'bg-primary/10 text-primary': selectedCarType === '', 'bg-zinc-100 text-zinc-700 dark:bg-zinc-800 dark:text-zinc-300': selectedCarType !== ''}"
                    class="flex items-center gap-1 rounded-full px-4 py-2 text-sm font-medium">
              Any
            </button>
            <button *ngFor="let type of vehicleTypes()"
                    (click)="selectedCarType = type"
                    [ngClass]="{'bg-primary/10 text-primary': selectedCarType === type, 'bg-zinc-100 text-zinc-700 dark:bg-zinc-800 dark:text-zinc-300': selectedCarType !== type}"
                    class="flex items-center gap-1 rounded-full px-4 py-2 text-sm font-medium">
              {{ type }}
            </button>
          </div>
        </div>
        <button type="submit" class="w-full rounded-xl bg-primary py-3.5 text-base font-bold text-white shadow-lg shadow-primary/30">
          Search
        </button>
      </form>

      <!-- Car listings -->
      <section class="mt-6 space-y-4">
        <!-- Loading state -->
        <div *ngIf="isLoading()" class="flex flex-col items-center justify-center py-12">
          <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-solid border-primary border-r-transparent"></div>
          <p class="mt-4 text-gray-600 dark:text-gray-400 text-center">Searching for available vehicles...</p>
        </div>

        <!-- Car listings - only show when not loading -->
        <div *ngIf="!isLoading() && getCars().length > 0">
          <div *ngFor="let car of getCars()"
               class="rounded-xl bg-white p-4 shadow-sm dark:bg-zinc-800/50"
               [class.opacity-60]="car.available === false">
            <div
              [ngClass]="{
                'hover:shadow-lg hover:shadow-black/20': car.available !== false
              }"
              class="flex items-start gap-5 rounded-2xl bg-white dark:bg-zinc-900 p-5 shadow-md shadow-black/10 transition"
            >
              <!-- Car image -->
              <div class="flex-shrink-0 relative">
                <img
                  [src]="car.imageUrl"
                  [alt]="car.type"
                  class="h-24 w-36 rounded-xl object-cover ring-1 ring-zinc-200 dark:ring-zinc-800"
                  [class.grayscale]="car.available === false"
                />
                <!-- Not Available badge -->
                <div *ngIf="car.available === false"
                     class="absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">
                  Not Available
                </div>
              </div>

              <!-- Car details -->
              <div class="flex flex-1 flex-col justify-between">
                <div>
                  <p class="text-sm text-zinc-500 dark:text-zinc-400">
                    {{ car.seats }} seats Â· {{ car.bags }} bags
                  </p>
                  <p class="mt-1 text-xl font-semibold text-zinc-900 dark:text-white">
                    {{ car.type }}
                  </p>
                  <p class="text-sm text-zinc-500 dark:text-zinc-400">
                    {{ car.model }}
                  </p>
                  <!-- Availability status message -->
                  <p *ngIf="car.available === false" class="mt-2 text-sm font-medium text-red-600 dark:text-red-400">
                    Not available for selected dates
                  </p>
                </div>

                <div class="mt-3 flex items-center justify-between">
                  <p class="text-2xl font-bold text-zinc-900 dark:text-white"
                     [class.text-zinc-400]="car.available === false"
                     [class.dark:text-zinc-600]="car.available === false">
                    ${{ car.price }}
                    <span class="text-sm font-normal text-zinc-500 dark:text-zinc-400"
                    >/day</span
                    >
                  </p>

                  <button
                    (click)="car.available !== false && selectCar(car)"
                    [disabled]="car.available === false"
                    [ngClass]="{
                      'bg-primary shadow-primary/30 hover:bg-primary/90 active:scale-95': car.available !== false,
                      'bg-zinc-400 dark:bg-zinc-600 cursor-not-allowed opacity-50': car.available === false
                    }"
                    class="rounded-xl px-5 py-2.5 text-sm font-semibold text-white shadow-md transition-all"
                  >
                    {{ car.available === false ? 'Unavailable' : 'Select Car' }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No results state -->
        <div *ngIf="!isLoading() && getCars().length === 0" class="flex flex-col items-center justify-center py-12">
          <svg class="h-16 w-16 text-gray-400 dark:text-gray-600 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-gray-600 dark:text-gray-400 text-center">No vehicles found for your search criteria.</p>
          <p class="text-sm text-gray-500 dark:text-gray-500 text-center mt-2">Try adjusting your dates or filters.</p>
        </div>
      </section>
    </main>
  </div>

  <app-footer-nav></app-footer-nav>
</div>

